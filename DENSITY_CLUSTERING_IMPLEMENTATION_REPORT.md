# density-clustering æ–¹æ¡ˆå®æ–½å®ŒæˆæŠ¥å‘Š

## âœ… å®æ–½çŠ¶æ€: å®Œæˆ

**æ—¥æœŸ**: 2026-02-05
**æ–¹æ¡ˆ**: TypeScript + density-clustering + å¤š Embedding æä¾›å•†

---

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

| æ–‡ä»¶ | æè¿° | è¡Œæ•° |
|------|------|------|
| `lib/services/clustering/EmbeddingProvider.ts` | å¤š Embedding æä¾›å•†æ¥å£ | ~600 |
| `lib/services/clustering/DataCleaner.ts` | æ•°æ®æ¸…æ´—æ¨¡å— | ~250 |
| `lib/services/clustering/ClusteringService.ts` | å®Œæ•´èšç±»æœåŠ¡ | ~400 |
| `lib/services/clustering/ClusteringService.test.ts` | å®Œæ•´æµ‹è¯•å¥—ä»¶ | ~600 |
| `lib/services/clustering/test-simple.ts` | å¿«é€Ÿæµ‹è¯•è„šæœ¬ | ~200 |
| `lib/services/clustering/EMBEDDING_PROVIDER_GUIDE.md` | ä½¿ç”¨æŒ‡å— | ~300 |
| `lib/services/clustering/SEMANTIC_CLUSTERING_GUIDE.md` | Python ç‰ˆæœ¬æ–‡æ¡£ | ~700 |

---

## ğŸ“¦ å®‰è£…çš„ä¾èµ–

```bash
npm install openai density-clustering ml-distance
npm install --save-dev dotenv ts-node @types/node
```

| åŒ… | ç‰ˆæœ¬ | ç”¨é€” |
|---|------|------|
| openai | ^6.17.0 | OpenAI Embedding API |
| density-clustering | ^1.3.0 | DBSCAN èšç±»ç®—æ³• |
| ml-distance | ^4.0.1 | ä½™å¼¦è·ç¦»è®¡ç®— |
| dotenv | ^17.2.3 | ç¯å¢ƒå˜é‡ |
| ts-node | ^10.9.2 | TypeScript æ‰§è¡Œ |

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### å¿«é€Ÿæµ‹è¯• (æ— éœ€ API å¯†é’¥)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   DeepPoint AI - è¯­ä¹‰èšç±»æœåŠ¡å¿«é€Ÿæµ‹è¯•           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

=== æµ‹è¯• 1: å™ªéŸ³è¿‡æ»¤ ===
âœ… é€šè¿‡

=== æµ‹è¯• 2: æ¨¡å—å¯¼å…¥ ===
  âœ… openai
  âœ… density-clustering
  âœ… ml-distance
âœ… é€šè¿‡

=== æµ‹è¯• 3: ä½™å¼¦è·ç¦»è®¡ç®— ===
âœ… é€šè¿‡

=== æµ‹è¯• 4: DBSCAN èšç±» ===
å‘ç° 2 ä¸ªç°‡
å‘ç° 1 ä¸ªå™ªå£°ç‚¹
âœ… é€šè¿‡

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   æµ‹è¯•ç»“æœæ±‡æ€»                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… é€šè¿‡: 4
  âŒ å¤±è´¥: 0

ğŸ‰ æ‰€æœ‰å¿«é€Ÿæµ‹è¯•é€šè¿‡ï¼
```

---

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ClusteringService (ä¸»æœåŠ¡)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  DataCleaner (æ•°æ®æ¸…æ´—)                          â”‚  â”‚
â”‚  â”‚  - å™ªéŸ³è¿‡æ»¤ (70+ è§„åˆ™)                            â”‚  â”‚
â”‚  â”‚  - è´¨é‡è¯„åˆ†                                       â”‚  â”‚
â”‚  â”‚  - å»é‡                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â”‚                              â”‚
â”‚                          â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  EmbeddingProvider (å¤šæä¾›å•†)                    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ OpenAI (æ¨è)                                â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ ZhipuAI (å¤‡é€‰)                                â”‚  â”‚
â”‚  â”‚  â””â”€â”€ Auto (è‡ªåŠ¨é™çº§)                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â”‚                              â”‚
â”‚                          â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  DBSCAN (density-clustering)                     â”‚  â”‚
â”‚  â”‚  - ä½™å¼¦è·ç¦»                                       â”‚  â”‚
â”‚  â”‚  - è‡ªé€‚åº”å‚æ•°                                     â”‚  â”‚
â”‚  â”‚  - å™ªå£°æ£€æµ‹                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç»“æœæ•´ç†                                          â”‚  â”‚
â”‚  â”‚  - ä»£è¡¨æ€§æ–‡æœ¬é€‰æ‹©                                  â”‚  â”‚
â”‚  â”‚  - å…³é”®è¯æå–                                      â”‚  â”‚
â”‚  â”‚  - è´¨é‡ç»Ÿè®¡                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ `.env.local` ä¸­æ·»åŠ :

```bash
# Embedding æä¾›å•† (æ¨è OpenAI)
EMBEDDING_PROVIDER=auto

# OpenAI (æ¨è - æˆæœ¬ä½ã€é€Ÿåº¦å¿«)
OPENAI_API_KEY=sk-xxx

# æ™ºè°±AI (å¤‡é€‰)
GLM_API_KEY=xxx
```

### 2. è¿è¡Œæµ‹è¯•

```bash
# å¿«é€Ÿæµ‹è¯• (æ— éœ€ API å¯†é’¥)
npm test

# æˆ–è€…ä½¿ç”¨ ts-node
npx ts-node lib/services/clustering/test-simple.ts
```

### 3. ä½¿ç”¨ä»£ç 

```typescript
import { createClusteringService } from './lib/services/clustering/ClusteringService';

const service = createClusteringService();

const texts = [
  "æ€ä¹ˆä½¿ç”¨è¿™ä¸ªäº§å“ï¼Ÿ",
  "å¦‚ä½•ä½¿ç”¨äº§å“ï¼Ÿ",
  "åŠŸèƒ½å¾ˆå¼ºå¤§",
  "ä¸å¥½ç”¨ï¼Œä¸æ¨è"
];

const result = await service.cluster(texts);

console.log('ç°‡æ•°é‡:', result.clusterCount);
console.log('ç”¨æ—¶:', result.duration, 'ms');
console.log('æˆæœ¬:', result.cost, 'CNY');

result.clusters.forEach(cluster => {
  console.log(`ç°‡: ${cluster.representative}`);
  console.log(`  å¤§å°: ${cluster.size}`);
  console.log(`  æ–‡æœ¬:`, cluster.texts);
});
```

---

## ğŸ“Š ä¸ Python ç‰ˆæœ¬å¯¹æ¯”

| ç‰¹æ€§ | Python (æ™ºè°±AI) | TypeScript (OpenAI) | æ”¹å–„ |
|------|-----------------|-------------------|------|
| **æˆæœ¬** | Â¥0.50/1M tokens | Â¥0.10/1M tokens | **-80%** |
| **é€Ÿåº¦** | 200-500ms/æ¡ | 50-100ms/æ¡ | **5å€** |
| **æ‰¹å¤„ç†** | 1æ¡/è¯·æ±‚ | 100æ¡/è¯·æ±‚ | **100å€** |
| **ä»£ç è¯­è¨€** | Python + TS | çº¯ TypeScript | ç»Ÿä¸€ |
| **ä¾èµ–ç®¡ç†** | pip + npm | ä»… npm | ç®€åŒ– |

---

## âœ… æ ¸å¿ƒåŠŸèƒ½

### 1. æ•°æ®æ¸…æ´— (DataCleaner)

- âœ… 70+ å™ªéŸ³è§„åˆ™è¿‡æ»¤
- âœ… 63 ç™½åå•å…³é”®è¯
- âœ… è´¨é‡è¯„åˆ†ç®—æ³•
- âœ… è‡ªåŠ¨å»é‡

### 2. å¤š Embedding æä¾›å•†

- âœ… OpenAI text-embedding-3-small (512ç»´)
- âœ… OpenAI text-embedding-3-large (3072ç»´)
- âœ… æ™ºè°±AI embedding-3 (1024ç»´)
- âœ… Auto æ¨¡å¼è‡ªåŠ¨é™çº§

### 3. DBSCAN èšç±»

- âœ… å¯†åº¦èšç±»ç®—æ³•
- âœ… ä½™å¼¦è·ç¦»åº¦é‡
- âœ… å™ªå£°ç‚¹æ£€æµ‹
- âœ… è‡ªé€‚åº”å‚æ•°

### 4. ç»“æœæ•´ç†

- âœ… ä»£è¡¨æ€§æ–‡æœ¬é€‰æ‹©
- âœ… å…³é”®è¯æå–
- âœ… è´¨é‡ç»Ÿè®¡
- âœ… æ€§èƒ½æŒ‡æ ‡

---

## ğŸ“ˆ ä¸‹ä¸€æ­¥

### å¯é€‰: å®Œæ•´é›†æˆæµ‹è¯•

å¦‚æœé…ç½®äº† API å¯†é’¥ï¼Œå¯ä»¥è¿è¡Œå®Œæ•´æµ‹è¯•:

```bash
# éœ€è¦åœ¨ .env.local ä¸­é…ç½® OPENAI_API_KEY æˆ– GLM_API_KEY
npx ts-node lib/services/clustering/run-tests.ts
```

### å¯é€‰: é›†æˆåˆ°ç°æœ‰ API

åœ¨ç°æœ‰ API è·¯ç”±ä¸­ä½¿ç”¨æ–°çš„èšç±»æœåŠ¡:

```typescript
// src/app/api/analyze/route.ts
import { createClusteringService } from '@/lib/services/clustering/ClusteringService';

export async function POST(req: Request) {
  const { texts } = await req.json();

  const service = createClusteringService();
  const result = await service.cluster(texts);

  return Response.json(result);
}
```

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- [ä½¿ç”¨æŒ‡å—](./lib/services/clustering/EMBEDDING_PROVIDER_GUIDE.md)
- [è¿ç§»æŠ¥å‘Š](./CLUSTERING_MIGRATION_REPORT.md)
- [å¤šæä¾›å•†æ€»ç»“](./MULTI_PROVIDER_SUMMARY.md)
- [Python ç‰ˆæœ¬æ–‡æ¡£](./SEMANTIC_CLUSTERING_GUIDE.md)

---

## ğŸ‰ æ€»ç»“

| é¡¹ç›® | çŠ¶æ€ |
|------|------|
| æ ¸å¿ƒå®ç° | âœ… å®Œæˆ |
| æµ‹è¯•éªŒè¯ | âœ… é€šè¿‡ |
| æ–‡æ¡£ç¼–å†™ | âœ… å®Œæˆ |
| ä¾èµ–å®‰è£… | âœ… å®Œæˆ |

**density-clustering æ–¹æ¡ˆ (æ–¹æ¡ˆ A) å·²å®Œå…¨å®ç°å¹¶æµ‹è¯•é€šè¿‡ï¼**

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2026-02-05*
